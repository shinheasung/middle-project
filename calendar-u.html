<!DOCTYPE html>
<html lang="ko">

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Template Mo">
    <link href="https://fonts.googleapis.com/css?family=Poppins:100,200,300,400,500,600,700,800,900" rel="stylesheet">

    <title>Daum IT-출석부(학생)</title>

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">


    <!-- Additional CSS Files -->
    <link rel="stylesheet" href="assets/css/fontawesome.css">
    <link rel="stylesheet" href="assets/css/templatemo-edu-meeting.css">
    <link rel="stylesheet" href="assets/css/owl.css">
    <link rel="stylesheet" href="assets/css/lightbox.css">
    <!--

TemplateMo 569 Edu Meeting

https://templatemo.com/tm-569-edu-meeting

-->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap');

        #cal {
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 10vh;
        }

        #leftbtn,
        #rightbtn {
            border: none;
            outline: none;
            background-color: transparent;
            padding: 0;
            cursor: pointer;
        }

        .wrapper {
            background: #fff;
            padding: 25px;
        }

        .wrapper .nav {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
        }

        .wrapper .nav .current-date {
            font-size: 24px;
            font-weight: 600;
        }

        .wrapper .nav button {
            width: 38px;
            height: 38px;
            font-size: 30px;
            color: #878787;
        }

        .calendar ul {
            display: flex;
            list-style: none;
            flex-wrap: wrap;
            text-align: center;
        }

        .calendar .weeks li {
            font-weight: 500;
        }



        .calendar ul li {
            width: calc(100% / 7);
            position: relative;
        }

        .calendar .days li {
            z-index: 1;
            margin-top: 20px;
        }

        .days li.inactive {
            color: #aaa;
        }


        .days li.active {
            color: #1e07ec;
        }

        .calendar .days li::before {
            position: absolute;
            content: '';
            height: 40px;
            width: 40px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border-radius: 50%;
            z-index: -1;

        }


        /* .days div.active::before {
        background: #008aff;
    } */

        .days li {
            position: relative;
            z-index: 1;
            margin-top: 30px;
            /* cursor: pointer; */
        }

        .days li button {
            width: 100%;
            height: 100%;
            background: transparent;
            border: none;
            /* cursor: pointer; */
        }

        /* .days li button:focus {
        outline: none;
    } */

        .days li .attendance-info {
            position: absolute;
            bottom: -20px;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #aaa;
        }

        .days li .attendance-info div {
            flex: 1;
            text-align: center;
            padding: 2px;
        }

        .days li.active .attendance-info {
            color: #fff;
        }

        li:nth-child(7),
        li:nth-child(14),
        li:nth-child(21),
        li:nth-child(28),
        li:nth-child(35){
            color: #1e07ec;
        }
        
        li:nth-child(1),
        li:nth-child(8),
        li:nth-child(15),
        li:nth-child(22),
        li:nth-child(29),
        li:nth-child(36){
            color: #ff1100;
        }
    </style>

</head>

<body>
    <!-- Sub Header -->
    <div class="sub-header">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-sm-8">
                    <div class="left-content">
                    </div>
                </div>
                <div class="col-lg-4 col-sm-4">
                    <div class="right-icons">
                        <ul>
                            <li id="loginLink"><a href="login.html">로그인</a></li>
                            <li id="signupLink"><a href="signup.html">회원가입</a></li>
                            <li id="userGreeting" style="display: none;"></li>
                            <li id="mypageLink" style="display: none;"><a href="mypage-u.html">마이페이지</a></li>
                            <li id="logoutLink" style="display: none">로그아웃</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- ***** Header Area Start ***** -->
    <header class="header-area header-sticky">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <nav class="main-nav">
                        <!-- ***** Logo Start ***** -->
                        <a href="index.html" class="logo" style="font-size: 46px;">
                            Daum IT
                        </a>
                        <!-- ***** Logo End ***** -->
                        <!-- ***** Menu Start ***** -->
                        <ul class="nav">
                            <li><a href="index.html">Home</a></li>
                            <li class="has-sub">
                                <a href="introduce-u.html">학원소개</a>
                                <ul class="sub-menu">
                                    <li><a href="introduce-u.html">학원 소개</a></li>
                                    <li><a href="teacher-u.html">교직원 소개</a></li>
                                    <li><a href="employment-u.html">취업현황</a></li>
                                </ul>
                            </li>
                            <li><a href="notice-u.html">공지사항</a></li>
                            <li>
                                <a href="community-u.html">커뮤니티</a>
                            </li>
                            <li class="has-sub">
                                <a href="FAQ-u.html">고객센터</a>
                                <ul class="sub-menu">
                                    <li><a href="FAQ-u.html">FAQ</a></li>
                                    <li><a href="counsel-u.html">문의 및 상담</a></li>
                                    <li><a href="location-u.html">오시는 길</a></li>
                                </ul>
                            </li>
                            <li><a href="calendar-u.html" class="active">출결조회</a></li>
                        </ul>
                        <a class='menu-trigger'>
                            <span>Menu</span>
                        </a>
                        <!-- ***** Menu End ***** -->
                    </nav>
                </div>
            </div>
        </div>
    </header>
    <!-- ***** Header Area End ***** -->

    <section class="heading-page header-text" id="top" style="background-image: url(assets/images/hd2.png);">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <h6>내일을 향해 나아가는 Daum IT</h6>
                    <h2>출결조회</h2>
                </div>
            </div>
        </div>
    </section>

    <section class="meetings-page" id="meetings">
        <div class="container"
            style="background-color: #ffffff; width: 100%; height: 1200px; color: #000000;  border-radius: 10px; text-align: center; ">
            <div class="wrapper">
                <div class="nav">
                    <button id="leftbtn" class="material-icons"> &lt; </button>
                    <p class="current-date"></p>
                    <button id="rightbtn" class="material-icons"> &gt; </button>
                </div>
                <div class="calendar">
                    <ul class="weeks">
                        <li>일</li>
                        <li>월</li>
                        <li>화</li>
                        <li>수</li>
                        <li>목</li>
                        <li>금</li>
                        <li>토</li>
                    </ul>
                    <ul class="days">

                    </ul>
                </div>
            </div>
            <div style="text-align: right; padding-right: 70px;">
                <button id="attPrint"
                    style="background-color: #4118ab; border: none; color: white; padding: 10px 20px; text-align: center; text-decoration: none; display: inline-block; font-size: 24px; margin: 4px 2px; cursor: pointer; border-radius: 5px; transition-duration: 0.4s;">출석부
                    출력</button>
            </div>
        </div>
        <div class="footer">
            <p>Copyright © 2022 Edu Meeting Co., Ltd. All Rights Reserved.
                <br>
                Design: <a href="https://templatemo.com" target="_parent" title="free css templates">TemplateMo</a>
                <br>
                Distibuted By: <a href="https://themewagon.com" target="_blank"
                    title="Build Better UI, Faster">ThemeWagon</a>
            </p>
        </div>
    </section>


    <!-- Scripts -->
    <!-- Bootstrap core JavaScript -->
    <script src="vendor/jquery/jquery.min.js"></script>


    <script src="assets/js/isotope.min.js"></script>
    <script src="assets/js/owl-carousel.js"></script>
    <script src="assets/js/lightbox.js"></script>
    <script src="assets/js/tabs.js"></script>
    <script src="assets/js/isotope.js"></script>
    <script src="assets/js/video.js"></script>
    <script src="assets/js/slick-slider.js"></script>
    <script src="assets/js/custom.js"></script>
    <script>
        //according to loftblog tut
        $('.nav li:first').addClass('active');

        var showSection = function showSection(section, isAnimate) {
            var
                direction = section.replace(/#/, ''),
                reqSection = $('.section').filter('[data-section="' + direction + '"]'),
                reqSectionPos = reqSection.offset().top - 0;

            if (isAnimate) {
                $('body, html').animate({
                    scrollTop: reqSectionPos
                },
                    800);
            } else {
                $('body, html').scrollTop(reqSectionPos);
            }

        };

        var checkSection = function checkSection() {
            $('.section').each(function () {
                var
                    $this = $(this),
                    topEdge = $this.offset().top - 80,
                    bottomEdge = topEdge + $this.height(),
                    wScroll = $(window).scrollTop();
                if (topEdge < wScroll && bottomEdge > wScroll) {
                    var
                        currentId = $this.data('section'),
                        reqLink = $('a').filter('[href*=\\#' + currentId + ']');
                    reqLink.closest('li').addClass('active').
                        siblings().removeClass('active');
                }
            });
        };

        $('.main-menu, .responsive-menu, .scroll-to-section').on('click', 'a', function (e) {
            e.preventDefault();
            showSection($(this).attr('href'), true);
        });

        $(window).scroll(function () {
            checkSection();
        });
    </script>

    <script>
        let date = new Date();
        let currYear = date.getFullYear(),
            currMonth = date.getMonth();
        const months = ['1월', '2월', '3월', '4월', '5월', '6월', '7월', '8월', '9월', '10월', '11월', '12월'];



        const currentDate = document.querySelector('.current-date');
        const daysTag = document.querySelector('.days');
        let liTag = '';

        



        const renderCalendar = () => {

            let lastDateofMonth = new Date(currYear, currMonth + 1, 0).getDate();

            liTag = ''; // liTag 초기화

            let firstDayofMonth = new Date(currYear, currMonth, 1).getDay();
            let lastDayofMonth = new Date(currYear, currMonth, lastDateofMonth).getDay();
            let lastDateofLastMonth = new Date(currYear, currMonth, 0).getDate();
            let allAttDate = 0;
            let attDate = 0;
            let nonAttDat = 0;

            for (let i = firstDayofMonth; i > 0; i--) {
                liTag += `<li class="inactive">${lastDateofLastMonth - i + 1}</li>`;
            }

            for (let i = 1; i <= lastDateofMonth; i++) {
                let key = `${currYear}년${currMonth + 1}월${i}일`;
                let result = getLocal(key);

                let isToday = i === date.getDate() && currMonth === new Date().getMonth() && currYear === new Date().getFullYear() ? 'active' : '';
                if (result !== null) {
                    allAttDate++;;
                    if (result == 1) {
                        attDate++;
                        liTag += `<li class="${isToday}">${i}<div style="height: 60px;color:green;">출석</div></li>`;
                    } else {
                        nonAttDat++;
                        liTag += `<li class="${isToday}">${i}<div style="height: 60px; color: red;">결석</div></li>`;
                    }
                } else {
                    liTag += `<li class="${isToday}">${i}<div style="height: 60px; color: red;">&nbsp;</div></li>`;

                }
            }
            localStorage.setItem('getKey',`${currYear}년${currMonth + 1}월`);
            localStorage.setItem('setMonth',`${currMonth + 1}`);
            let attAvr = ((attDate / allAttDate) * 100).toFixed(2);
            if (isNaN(attAvr)) {
                attAvr = 0;
            }

            currentDate.innerHTML = `${currYear}년 ${months[currMonth]} <span style="font-size: 18px;">(총: ${allAttDate}  출석: ${attDate}  결석: ${nonAttDat}  출석률: ${attAvr}%)</span>`;
            for (let i = lastDayofMonth; i < 6; i++) {
                liTag += `<li class="inactive">${i - lastDayofMonth + 1}</li>`;
            }
            daysTag.innerHTML = liTag;

        };
        renderCalendar();

        const leftbtn = document.getElementById("leftbtn");
        const rightbtn = document.getElementById("rightbtn");
        leftbtn.addEventListener('click', () => {
            currMonth--;
            if (currMonth < 0) {
                currMonth = 11;
                currYear--;
            }
            renderCalendar();
        });
        rightbtn.addEventListener('click', () => {
            currMonth++;
            if (currMonth > 11) {
                currMonth = 0;
                currYear++;
            }
            renderCalendar();
        });













        function getLocal(key) {
            const isLoggedIn = sessionStorage.getItem("login");
            const userInfo = JSON.parse(isLoggedIn);
            let userNum = "" + userInfo.num;
            let checkAttend = JSON.parse(localStorage.getItem(key));


            if (checkAttend !== null) {
                let attendInfo = checkAttend.attend;
                for (let i = 0; i < attendInfo.length; i++) {
                    if (userNum == attendInfo[i].membernum) {
                        if (attendInfo[i].att) {
                            return 1;
                        } else if (!attendInfo[i].att) {
                            return 2;
                        }
                    }
                }
            } else {
                return null;
            }

        }

        let url = `att-print.html`;
        const attPrint = document.getElementById('attPrint');
        attPrint.addEventListener('click', function () {
            window.open(url, "", "width=1800,height=1000")
        })



    </script>
    <script>

        document.addEventListener("DOMContentLoaded", function () {
            // 페이지가 로드되면 실행될 코드

            // sessionStorage에서 로그인 정보 가져오기
            const isLoggedIn = sessionStorage.getItem("login");
            if (sessionStorage.length === 2) {

                if (isLoggedIn) {
                    const userInfo = JSON.parse(isLoggedIn);
                    const userName = userInfo.name;
                    const userGreeting = document.getElementById("userGreeting");

                    // 로그인, 회원가입 링크 숨기기
                    const loginLink = document.getElementById("loginLink");
                    const signupLink = document.getElementById("signupLink");
                    loginLink.style.display = "none";
                    signupLink.style.display = "none";

                    userGreeting.style.display = "inline-block";
                    userGreeting.innerHTML = `<span style="color:white; font-weight: bold;">${userName}님</span>`;

                    // 마이페이지 링크 표시
                    const mypageLink = document.getElementById("mypageLink");
                    mypageLink.style.display = "inline-block";
                    mypageLink.innerHTML = "<a href='mypage-u.html' style='color: white; text-decoration: none;'>마이페이지</a>";
                    //로그아웃 링크 표시
                    const logoutLink = document.getElementById("logoutLink");
                    logoutLink.style.display = "inline-block";
                    logoutLink.innerHTML = "<a href='#'; style='color: white; text-decoration: none;'>로그아웃</a>";
                    // 로그아웃 기능
                    logoutLink.addEventListener("click", function () {
                        sessionStorage.clear();
                        window.location.href = "index.html";
                    })
                }
            } else {
                alert('로그인 후 이용하세요.')
                window.location.href = "login.html";
            }
        });


    </script>

</body>


</body>

</html>